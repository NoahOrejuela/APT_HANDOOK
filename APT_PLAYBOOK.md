import os

#write payloads on computer, using py2many,  convert payloads to nim
#write exfiltration payloads in go

#C2 should have database of payloads, hosts [ips, localtime, status(machine on, machine off, users online)], nothing more

Concept : conceptual payloads too complex or very early on in development.
InProgress : actively developed payloads.
Complete: payloads ready to deploy.
Staple: payloads that are entirely bespoke and are needed to keep operation running.


#write payloads on computer, using py2many, convert payloads to nim
#write exfiltration payloads in go, speed and stealth are important

For payloads, have sensor payload, if WinDefender updates, if 3rd party updates, delete all payloads with flags,
and all logic to exfiltrate should be manually removed by commands.

3 levels of sensitivty based on OSINT: (operational behavior based on target chosen and research)

    fortissimo: noisy, doesn't matter if detected, push payloads, maximize stolen credentials or information.

        forte: quite, stalking behavior with a designated end date, the end of persistence on system is known and
        exit conditions are already determined. (destructive or otherwise).

            piano: persistence is considered to be the highest priority, second to exfiltration,
            whisp targets can eventually become elephant or lynx operations but rarely do. 
            Simply having access to such computers is enough to infomr decisions.


flags: flags are strings like "11/19/2025(infection date).23:09:46(infection time).target_ip$.private_ip$.public_ip$.[Y],[N],[1],[5],[7],[Y],[Y],[N]"

flags (cont):
the exmaple array [Y],[N],[1],[5],[7],[Y],[Y],[N]
contains info on the infected machine

[index 0] or [Y] in our example shows that payloads have been deployed on machine

[index 1] or [N] in our exmaple shows that exfiltration is not on/hasn't been activated yet

[index 2] or [1] in our example shows that one user(s) account is on machine

[index 3] or [5] in our example shows that 5 antivirus or IDS are on system based on searching functions for
popular binaries, KVRT binaries, WinRM binaries, WinDefender binaries

[index 4] or [7] in our example shows the amount of payloads on system, the FLAG_IND4 integer is counted here,
the counted integer increments +1 depending on whether or not a payload has a valid length string on line 3.
Inside the payloads, on line 3, it should be a 64character string of hexadecimal generated by logic on C2.

[index 5] or [Y] in our example shows us that a cleanup protocol or final.stage has been deployed on this host

[index 6] or [Y] in our example shows us that all files were cleaned up successfully

[index 7] or [N] in our example tells us that no encryption of file system payload was dropped, or drivesmasher
payload. These payloads are exclusively for targets that have a sophisticated forensic capability. 
Such capacities should be hoarded. 


C2 will have multiple components for parsing. 

Payloads with no flags, should be portions of other malware that have been dropped to confuse and delay
proper forensic investigations.

Dropped binaries of c/c++ and rust binaries of open source ransomware is valuable as a sort of feigned "gotcha"
could trick AI based IDS/IDE due to temperature hijacking. More dangerous malware families are given a higher temp
or detection factor from AI based AVs.

DNS tunneling, research quite DNS tunneling.

Using Go: 
- a leigthweight VPN can be established with hardcoded IPs.
- C2s woulnd need to bounce regularly

### MAXIMUM PRIORITY FOR GO BASED PAYLOADS AND EXFILTRATION !!!

ALL EXFILTRATED DATA SHOULD BE SENT IN AS DISCREET OF A METHOD AS POSSIBLE
ie:
riding packets out of normal traffic when streaming video
set up a discreet apache instance for extremely quick and dense exfil

two modes of exfil based on net info size and weight. 
-different information takes longer to encode and send that just plaintext or .csv files
-different file types may not be compressable, hence these files should be deleted instead of exfiltrated

CSVPACKER: a payload that packs user, time, enumd. AVs or IDS/IDE, and more.
TXTPACKER: a payload that packs user directory, and application list, also dev packages.
MAXPACKER: a cleanup payload that exfiltrates anything it could find, pulling max strings it can. only deployable
when user is not at computer.

RUNNINGMAN: Use initial access payload to get reverse TCP shell, if that fails use RUNNINGMAN framework
to build a shell on victim through other vulnerability.

DRVSMASHER: Use payload for machines on final.stage or EXIT phase. Payload uses quickmath to scramble memory addr.
for multiple OS utility. Services affected: ntdll.dll, bootmgr.efi, sfc_os.dll, sfcfiles.dll.
-completely disables default windows recovery after payload launch
-eviscerates file system
-corrupts bootloader

DRVSMASHER should also touch the MBR somehow, research ways to scramble MBR. 
### NEEDS TO HAVE SELF PURGING FUNCTIONALITY

REWIND: able to recover the crypted files of previous DRVSMASHER payload, uses inverse mathematics used in initial
crypt.

TSPRINT: touches search engine tokens, discord tokens, secret keys and network passwords. packs them into a csvfor
exfil.

MongooSPRINT: sweeps up all leftover .txt and .csv files and sends them OTW to C2 via apache instance. If 
unavailable, then use Powershell, requires AVs and IDS/IDE are disabled or crippled.

SCHIZO: This is the sensor payload packed into the initial access payloads. Listens for updates, if AVs update or Windefender updates, all payloads with flags mentioned above should be immediately removed from system.

WhisperMatic: this deletes all payloads with flags. Deletes itself afterward.

### Cleanup is the most important functionality to recieve constant testing. Forensics shouldn't be possible.

TimescaleDB: used to systematically organize info extracted

Databases are individual based on operation, nation affected, and vendor

structure looks somehting like this:

OP: RUNWAYTIGER
NTNS: UK, CHINA, RUSSIA
Vendors: Mandiant (ntn), bytedance (ntn), Kaspersky (ntn)











